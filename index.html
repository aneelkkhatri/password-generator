<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Password Generator</title>
	<style type="text/css">
		input {
			font-family: monospace;
		}
		input, button {
			font-size: 48px;
		}
	</style>
</head>
<body>
	<input id="password"></input>
	<!-- <button id="button">Generate</button> -->
	<script type="text/javascript">
		let passwordLength = 10;
		let digits = '1234567890';
		let lowerCaseLetters = 'abcdefghijklmnopqrstuvwxyz';
		let upperCaseLetters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
		let symbols = " !\"#$%&'()*+,-./:;<=>?@[\]^_`{|}~";
		let list = [ digits, lowerCaseLetters, upperCaseLetters, symbols ];
		let allowed = [0, 1, 2, 3];
		let allowedCharactersList = allowed.map(index => list[index]);
		let combinedCharacters = allowedCharactersList.join('');

		function generate(length) {
			let password = [];
			for (let i = 0; i < allowedCharactersList.length; ++i) {
				password.push(allowedCharactersList[i][Math.floor(Math.random()*allowedCharactersList[i].length)])
			}
			for (let i = allowedCharactersList.length; i < length; ++i) {
			    password.push(combinedCharacters[Math.floor(Math.random()*combinedCharacters.length)])
			}
			console.log('before', password);
			for (let i = 0; i < password.length; ++i) {
				let j = Math.floor(Math.random() * password.length);
				let tmp = password[i];
				password[i] = password[j];
				password[j] = tmp;
			}
			console.log('after', password);
			return password.join('');
		}

		// document.getElementById('button').addEventListener('click', e => {
		// 	let start = Date.now();
			function generateAndLoad() {
				// if (Date.now () - start > 100) {
				// 	return;
				// }

				document.getElementById('password').value = generate(10);
				setTimeout(generateAndLoad, 100);
			}
			generateAndLoad();
		// });
	</script>
</body>
</html>